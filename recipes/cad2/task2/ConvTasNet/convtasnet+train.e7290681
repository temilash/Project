
CommandNotFoundError: Your shell has not been properly configured to use 'conda activate'.
To initialize your shell, run

    $ conda init <SHELL_NAME>

Currently supported shells are:
  - bash
  - fish
  - tcsh
  - xonsh
  - zsh
  - powershell

See 'conda init --help' for more information and options.

IMPORTANT: You may need to close and restart your shell after running 'conda init'.


/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/2
/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/2
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 2 processes
----------------------------------------------------------------------------------------------------

LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name      | Type             | Params | Mode 
-------------------------------------------------------
0 | model     | ConvTasNetStereo | 10.8 M | train
1 | loss_func | L1Loss           | 0      | train
-------------------------------------------------------
10.8 M    Trainable params
0         Non-trainable params
10.8 M    Total params
43.387    Total estimated model params size (MB)
456       Modules in train mode
0         Modules in eval mode
/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:434: It is recommended to use `self.log('val_loss', ..., sync_dist=True)` when logging on epoch level in distributed setting to accumulate the metric across devices.
[rank0]: Traceback (most recent call last):
[rank0]:   File "/nobackup/sc22ol/Project/recipes/cad2/task2/ConvTasNet/train.py", line 161, in <module>
[rank0]:     main(arg_dic)
[rank0]:   File "/nobackup/sc22ol/Project/recipes/cad2/task2/ConvTasNet/train.py", line 131, in main
[rank0]:     trainer.fit(system)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 539, in fit
[rank0]:     call._call_and_handle_interrupt(
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 46, in _call_and_handle_interrupt
[rank0]:     return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
[rank0]:     return function(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 575, in _fit_impl
[rank0]:     self._run(model, ckpt_path=ckpt_path)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 982, in _run
[rank0]:     results = self._run_stage()
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1026, in _run_stage
[rank0]:     self.fit_loop.run()
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 216, in run
[rank0]:     self.advance()
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 455, in advance
[rank0]:     self.epoch_loop.run(self._data_fetcher)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 150, in run
[rank0]:     self.advance(data_fetcher)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 320, in advance
[rank0]:     batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 192, in run
[rank0]:     self._optimizer_step(batch_idx, closure)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 270, in _optimizer_step
[rank0]:     call._call_lightning_module_hook(
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 171, in _call_lightning_module_hook
[rank0]:     output = fn(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1302, in optimizer_step
[rank0]:     optimizer.step(closure=optimizer_closure)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/core/optimizer.py", line 154, in step
[rank0]:     step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 270, in optimizer_step
[rank0]:     optimizer_output = super().optimizer_step(optimizer, closure, model, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 239, in optimizer_step
[rank0]:     return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 123, in optimizer_step
[rank0]:     return optimizer.step(closure=closure, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/optim/optimizer.py", line 493, in wrapper
[rank0]:     out = func(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/optim/optimizer.py", line 91, in _use_grad
[rank0]:     ret = func(self, *args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/optim/adam.py", line 223, in step
[rank0]:     loss = closure()
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 109, in _wrap_closure
[rank0]:     closure_result = closure()
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 146, in __call__
[rank0]:     self._result = self.closure(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank0]:     return func(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 131, in closure
[rank0]:     step_output = self._step_fn()
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 319, in _training_step
[rank0]:     training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 323, in _call_strategy_hook
[rank0]:     output = fn(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in training_step
[rank0]:     return self._forward_redirection(self.model, self.lightning_module, "training_step", *args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 641, in __call__
[rank0]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1643, in forward
[rank0]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1459, in _run_ddp_forward
[rank0]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 634, in wrapped_forward
[rank0]:     out = method(*_args, **_kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/asteroid/engine/system.py", line 118, in training_step
[rank0]:     loss = self.common_step(batch, batch_nb, train=True)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/asteroid/engine/system.py", line 101, in common_step
[rank0]:     est_targets = self(inputs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/asteroid/engine/system.py", line 73, in forward
[rank0]:     return self.model(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/nobackup/sc22ol/Project/recipes/cad2/task2/ConvTasNet/local/tasnet.py", line 137, in forward
[rank0]:     est_mask = self.separator(mixture_w)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/nobackup/sc22ol/Project/recipes/cad2/task2/ConvTasNet/local/tasnet.py", line 311, in forward
[rank0]:     score = self.network(mixture_w)  # [M, N, K] -> [M, C*N, K]
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank0]:     input = module(input)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank0]:     input = module(input)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank0]:     input = module(input)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/nobackup/sc22ol/Project/recipes/cad2/task2/ConvTasNet/local/tasnet.py", line 361, in forward
[rank0]:     out = self.net(x)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank0]:     input = module(input)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/nobackup/sc22ol/Project/recipes/cad2/task2/ConvTasNet/local/tasnet.py", line 411, in forward
[rank0]:     return self.net(x)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank0]:     input = module(input)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:   File "/nobackup/sc22ol/Project/recipes/cad2/task2/ConvTasNet/local/tasnet.py", line 499, in forward
[rank0]:     gLN_y = self.gamma * (y - mean) / torch.pow(var + EPS, 0.5) + self.beta
[rank0]: torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 104.00 MiB. GPU 0 has a total capacity of 31.74 GiB of which 35.12 MiB is free. Including non-PyTorch memory, this process has 31.70 GiB memory in use. Of the allocated memory 31.11 GiB is allocated by PyTorch, and 119.55 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[rank1]: Traceback (most recent call last):
[rank1]:   File "/nobackup/sc22ol/Project/recipes/cad2/task2/ConvTasNet/train.py", line 161, in <module>
[rank1]:     main(arg_dic)
[rank1]:   File "/nobackup/sc22ol/Project/recipes/cad2/task2/ConvTasNet/train.py", line 131, in main
[rank1]:     trainer.fit(system)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 539, in fit
[rank1]:     call._call_and_handle_interrupt(
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 46, in _call_and_handle_interrupt
[rank1]:     return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 105, in launch
[rank1]:     return function(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 575, in _fit_impl
[rank1]:     self._run(model, ckpt_path=ckpt_path)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 982, in _run
[rank1]:     results = self._run_stage()
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1026, in _run_stage
[rank1]:     self.fit_loop.run()
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 216, in run
[rank1]:     self.advance()
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py", line 455, in advance
[rank1]:     self.epoch_loop.run(self._data_fetcher)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 150, in run
[rank1]:     self.advance(data_fetcher)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 320, in advance
[rank1]:     batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 192, in run
[rank1]:     self._optimizer_step(batch_idx, closure)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 270, in _optimizer_step
[rank1]:     call._call_lightning_module_hook(
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 171, in _call_lightning_module_hook
[rank1]:     output = fn(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/core/module.py", line 1302, in optimizer_step
[rank1]:     optimizer.step(closure=optimizer_closure)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/core/optimizer.py", line 154, in step
[rank1]:     step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/strategies/ddp.py", line 270, in optimizer_step
[rank1]:     optimizer_output = super().optimizer_step(optimizer, closure, model, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 239, in optimizer_step
[rank1]:     return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 123, in optimizer_step
[rank1]:     return optimizer.step(closure=closure, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/optim/optimizer.py", line 493, in wrapper
[rank1]:     out = func(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/optim/optimizer.py", line 91, in _use_grad
[rank1]:     ret = func(self, *args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/optim/adam.py", line 223, in step
[rank1]:     loss = closure()
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/plugins/precision/precision.py", line 109, in _wrap_closure
[rank1]:     closure_result = closure()
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 146, in __call__
[rank1]:     self._result = self.closure(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank1]:     return func(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 131, in closure
[rank1]:     step_output = self._step_fn()
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 319, in _training_step
[rank1]:     training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 323, in _call_strategy_hook
[rank1]:     output = fn(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in training_step
[rank1]:     return self._forward_redirection(self.model, self.lightning_module, "training_step", *args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 641, in __call__
[rank1]:     wrapper_output = wrapper_module(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1643, in forward
[rank1]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1459, in _run_ddp_forward
[rank1]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 634, in wrapped_forward
[rank1]:     out = method(*_args, **_kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/asteroid/engine/system.py", line 118, in training_step
[rank1]:     loss = self.common_step(batch, batch_nb, train=True)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/asteroid/engine/system.py", line 101, in common_step
[rank1]:     est_targets = self(inputs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/asteroid/engine/system.py", line 73, in forward
[rank1]:     return self.model(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/nobackup/sc22ol/Project/recipes/cad2/task2/ConvTasNet/local/tasnet.py", line 137, in forward
[rank1]:     est_mask = self.separator(mixture_w)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/nobackup/sc22ol/Project/recipes/cad2/task2/ConvTasNet/local/tasnet.py", line 311, in forward
[rank1]:     score = self.network(mixture_w)  # [M, N, K] -> [M, C*N, K]
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank1]:     input = module(input)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank1]:     input = module(input)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank1]:     input = module(input)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/nobackup/sc22ol/Project/recipes/cad2/task2/ConvTasNet/local/tasnet.py", line 361, in forward
[rank1]:     out = self.net(x)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank1]:     input = module(input)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/nobackup/sc22ol/Project/recipes/cad2/task2/ConvTasNet/local/tasnet.py", line 411, in forward
[rank1]:     return self.net(x)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank1]:     input = module(input)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:   File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:   File "/nobackup/sc22ol/Project/recipes/cad2/task2/ConvTasNet/local/tasnet.py", line 499, in forward
[rank1]:     gLN_y = self.gamma * (y - mean) / torch.pow(var + EPS, 0.5) + self.beta
[rank1]: torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 104.00 MiB. GPU 1 has a total capacity of 31.74 GiB of which 35.12 MiB is free. Including non-PyTorch memory, this process has 31.70 GiB memory in use. Of the allocated memory 31.11 GiB is allocated by PyTorch, and 119.55 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception ignored in atexit callback: <function _destroy_dist_connection at 0x2b2cb5d26950>
Traceback (most recent call last):
  File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/lightning_fabric/utilities/distributed.py", line 317, in _destroy_dist_connection
    torch.distributed.destroy_process_group()
  File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 2146, in destroy_process_group
    _shutdown_backend(pg_to_shutdown)
  File "/home/home01/sc22ol/.conda/envs/clarity/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1815, in _shutdown_backend
    backend._shutdown()
torch.distributed.DistBackendError: NCCL error in: /pytorch/torch/csrc/distributed/c10d/NCCLUtils.cpp:133, unhandled cuda error (run with NCCL_DEBUG=INFO for details), NCCL version 2.21.5
ncclUnhandledCudaError: Call to CUDA function failed.
Last error:
Cuda failure 'out of memory'
